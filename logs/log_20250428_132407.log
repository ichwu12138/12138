2025-04-28 13:24:07,209 [INFO] root - 程序启动，日志文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\logs\log_20250428_132407.log
2025-04-28 13:24:07,500 [INFO] __main__ - 正在启动程序...
2025-04-28 13:24:07,500 [DEBUG] __main__ - Python版本: 3.13.2 (tags/v3.13.2:4f8bb39, Feb  4 2025, 15:23:48) [MSC v.1942 64 bit (AMD64)]
2025-04-28 13:24:07,501 [DEBUG] __main__ - 当前工作目录: C:\Users\mengy\Desktop\ZK_LogicBom_Builder
2025-04-28 13:24:07,501 [DEBUG] __main__ - src_dir路径: c:\Users\mengy\Desktop\ZK_LogicBom_Builder
2025-04-28 13:24:07,531 [INFO] __main__ - 正在创建语言选择对话框...
2025-04-28 13:24:09,066 [INFO] gui.language_dialog_tk - 已选择语言: zh
2025-04-28 13:24:09,084 [INFO] __main__ - 语言选择结果: zh
2025-04-28 13:24:09,084 [INFO] __main__ - 正在创建主题选择对话框...
2025-04-28 13:24:09,084 [DEBUG] gui.theme_dialog_tk - 创建主题选择对话框
2025-04-28 13:24:09,089 [DEBUG] gui.theme_dialog_tk - 主题选择对话框创建完成
2025-04-28 13:24:09,737 [DEBUG] gui.theme_dialog_tk - 用户选择了light主题
2025-04-28 13:24:09,761 [INFO] __main__ - 主题选择结果: light
2025-04-28 13:24:09,773 [INFO] __main__ - 正在配置主窗口...
2025-04-28 13:24:09,923 [INFO] __main__ - 开始创建MainWindow实例...
2025-04-28 13:24:09,924 [INFO] core.logic_builder - 已加载 2 条规则
2025-04-28 13:24:09,988 [INFO] gui.logic_panel - 规则未加载状态，等待用户确认后再加载规则
2025-04-28 13:24:10,003 [INFO] __main__ - MainWindow实例创建完成
2025-04-28 13:24:10,268 [INFO] __main__ - 开始mainloop()...
2025-04-28 13:24:12,274 [INFO] core.config_processor - 找到工作表: ['TD', '0.模板&Vorlage', '1.Fahrgestell', '2.Fahrzeug allgemein', '3.Beschriftung&Kennzeichnung', '4. Anbauten&Fahrgestellarbeiten', '5. Fahrer_Mannschaftsraum', '6.Koffer', '7.Lichtmast', '8.Pumpenanlage', '9.Seilwinde&Generator', '10.Halterungen']
2025-04-28 13:24:12,274 [DEBUG] core.config_processor - 跳过工作表: TD
2025-04-28 13:24:12,274 [DEBUG] core.config_processor - 跳过工作表: 0.模板&Vorlage
2025-04-28 13:24:12,274 [INFO] core.config_processor - 处理工作表: 1.Fahrgestell -> 模块: 1.Fahrgestell
2025-04-28 13:24:12,291 [INFO] core.config_processor - 处理工作表: 2.Fahrzeug allgemein -> 模块: 2.Fahrzeug allgemein
2025-04-28 13:24:12,307 [INFO] core.config_processor - 处理工作表: 3.Beschriftung&Kennzeichnung -> 模块: 3.Beschriftung&Kennzeichnung
2025-04-28 13:24:12,323 [INFO] core.config_processor - 处理工作表: 4. Anbauten&Fahrgestellarbeiten -> 模块: 4.Anbauten&Fahrgestellarbeiten
2025-04-28 13:24:12,339 [INFO] core.config_processor - 处理工作表: 5. Fahrer_Mannschaftsraum -> 模块: 5.Fahrer_Mannschaftsraum
2025-04-28 13:24:12,360 [INFO] core.config_processor - 处理工作表: 6.Koffer -> 模块: 6.Koffer
2025-04-28 13:24:12,376 [INFO] core.config_processor - 处理工作表: 7.Lichtmast -> 模块: 7.Lichtmast
2025-04-28 13:24:12,390 [INFO] core.config_processor - 处理工作表: 8.Pumpenanlage -> 模块: 8.Pumpenanlage
2025-04-28 13:24:12,405 [INFO] core.config_processor - 处理工作表: 9.Seilwinde&Generator -> 模块: 9.Seilwinde&Generator
2025-04-28 13:24:12,422 [INFO] core.config_processor - 处理工作表: 10.Halterungen -> 模块: 10.Halterungen
2025-04-28 13:24:12,437 [INFO] gui.config_panel - 成功导入配置文件: C:/Users/mengy/Desktop/配置选项_Konfigurationsoptions.xlsm
2025-04-28 13:24:12,441 [INFO] gui.main_window_tk - 成功保存配置文件路径到app_config.json: C:/Users/mengy/Desktop/配置选项_Konfigurationsoptions.xlsm
2025-04-28 13:24:12,441 [INFO] gui.config_panel - 已保存配置文件路径到app_config.json: C:/Users/mengy/Desktop/配置选项_Konfigurationsoptions.xlsm
2025-04-28 13:24:13,570 [INFO] core.bom_processor - 开始导入BOM文件: C:/Users/mengy/Desktop/Bom.xlsx
2025-04-28 13:24:13,570 [INFO] core.bom_processor - 已清空现有数据
2025-04-28 13:24:13,570 [INFO] core.bom_processor - 正在读取Excel文件...
2025-04-28 13:24:13,574 [INFO] core.bom_processor - 成功打开Excel文件，包含以下工作表: ['Max-Gruppe']
2025-04-28 13:24:13,574 [INFO] core.bom_processor - 正在读取 Max-Gruppe 工作表...
2025-04-28 13:24:13,583 [INFO] core.bom_processor - 成功读取工作表，共 154 行数据
2025-04-28 13:24:13,583 [INFO] core.bom_processor - 所有必需列均存在，开始处理数据...
2025-04-28 13:24:13,585 [INFO] core.bom_processor - 过滤空层级后剩余 153 行数据
2025-04-28 13:24:13,585 [INFO] core.bom_processor - 
开始处理数据...
2025-04-28 13:24:13,589 [INFO] core.bom_processor - 
数据处理完成，成功处理 {processed_count} 行数据
2025-04-28 13:24:13,589 [INFO] core.bom_processor - 第 1 级节点数量: 1
2025-04-28 13:24:13,589 [INFO] core.bom_processor - 第 2 级节点数量: 133
2025-04-28 13:24:13,589 [INFO] core.bom_processor - 第 3 级节点数量: 19
2025-04-28 13:24:13,589 [INFO] core.bom_processor - BOM文件导入成功，共处理 153 个项目
2025-04-28 13:24:13,590 [INFO] gui.bom_panel - 成功导入BOM文件: C:/Users/mengy/Desktop/Bom.xlsx
2025-04-28 13:24:13,590 [INFO] gui.bom_panel - 开始刷新树状图
2025-04-28 13:24:13,591 [INFO] gui.bom_panel - 树状图刷新完成
2025-04-28 13:24:13,592 [INFO] gui.main_window_tk - 成功保存BOM文件路径到app_config.json: C:/Users/mengy/Desktop/Bom.xlsx
2025-04-28 13:24:13,592 [INFO] gui.bom_panel - 已保存BOM文件路径到app_config.json: C:/Users/mengy/Desktop/Bom.xlsx
2025-04-28 13:24:14,845 [INFO] gui.main_window_tk - 用户确认加载规则，设置规则已加载标志为True
2025-04-28 13:24:14,845 [INFO] core.logic_builder - 准备从临时文件加载规则: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:24:14,845 [INFO] core.logic_builder - 开始导入规则文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:24:14,846 [INFO] core.logic_builder - 已清空现有规则
2025-04-28 13:24:14,846 [DEBUG] core.logic_builder - 成功导入规则: ID=BL01
2025-04-28 13:24:14,846 [DEBUG] core.logic_builder - 成功导入规则: ID=BL03
2025-04-28 13:24:14,857 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 2 条规则
2025-04-28 13:24:14,857 [INFO] gui.logic_panel - 收到规则变更事件: type=imported, rule_id=None
2025-04-28 13:24:14,858 [INFO] gui.logic_panel - 规则已加载状态，开始更新已保存规则框架
2025-04-28 13:24:14,858 [INFO] gui.logic_panel - 开始加载规则到已保存规则框架
2025-04-28 13:24:14,858 [DEBUG] gui.logic_panel - 从LogicBuilder获取到 2 条规则
2025-04-28 13:24:14,858 [DEBUG] gui.logic_panel - 添加规则ID: 1 到已使用集合
2025-04-28 13:24:14,858 [DEBUG] gui.logic_panel - 添加规则ID: 3 到已使用集合
2025-04-28 13:24:14,859 [INFO] gui.logic_panel - 成功加载 2 条规则到已保存规则框架
2025-04-28 13:24:14,859 [INFO] core.logic_builder - 规则导入完成，成功导入 2 条规则
2025-04-28 13:24:14,859 [INFO] core.logic_builder - 从临时文件加载规则完成
2025-04-28 13:24:14,859 [INFO] gui.main_window_tk - 开始刷新逻辑面板显示
2025-04-28 13:24:14,859 [INFO] gui.logic_panel - 开始加载规则到已保存规则框架
2025-04-28 13:24:14,859 [DEBUG] gui.logic_panel - 从LogicBuilder获取到 2 条规则
2025-04-28 13:24:14,860 [DEBUG] gui.logic_panel - 添加规则ID: 1 到已使用集合
2025-04-28 13:24:14,860 [DEBUG] gui.logic_panel - 添加规则ID: 3 到已使用集合
2025-04-28 13:24:14,860 [INFO] gui.logic_panel - 成功加载 2 条规则到已保存规则框架
2025-04-28 13:24:14,860 [INFO] gui.main_window_tk - 逻辑面板显示刷新完成
2025-04-28 13:24:17,978 [INFO] gui.logic_library_window - 已加载 2 条 BOM 逻辑关系规则
2025-04-28 13:24:22,319 [DEBUG] gui.config_panel - ConfigPanel: 双击选中项 ID: I07B
2025-04-28 13:24:22,320 [DEBUG] gui.config_panel - ConfigPanel: 选中项文本: K03_03_02 RAL 3020 verkehrsrot
2025-04-28 13:24:22,320 [DEBUG] gui.config_panel - ConfigPanel: 提取的代码: K03_03_02
2025-04-28 13:24:22,320 [INFO] gui.config_panel - ConfigPanel: 准备插入K码: K03_03_02
2025-04-28 13:24:22,320 [DEBUG] gui.config_panel - ConfigPanel: 获取根窗口成功
2025-04-28 13:24:22,320 [DEBUG] gui.config_panel - ConfigPanel: 获取MainWindow实例成功
2025-04-28 13:24:22,320 [DEBUG] gui.config_panel - ConfigPanel: 找到逻辑面板
2025-04-28 13:24:22,320 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: K03_03_02
2025-04-28 13:24:22,320 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: K_code, 内容: K03_03_02, 当前表达式: K03_03_02 
2025-04-28 13:24:22,321 [INFO] gui.config_panel - ConfigPanel: 成功发送代码到逻辑面板: K03_03_02
2025-04-28 13:24:23,297 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: operator, 内容: →, 当前表达式: K03_03_02  → 
2025-04-28 13:24:24,664 [DEBUG] gui.bom_panel - BomPanel: 双击选中项 ID: I025
2025-04-28 13:24:24,666 [DEBUG] gui.bom_panel - BomPanel: 选中项文本: [2] PL-Sitze02
2025-04-28 13:24:26,693 [DEBUG] gui.bom_panel - BomPanel: 双击选中项 ID: I04B
2025-04-28 13:24:26,694 [DEBUG] gui.bom_panel - BomPanel: 选中项文本: 1161296 - PA-Sitz Std. mechanisch / BA-seat mechanically
Z-Cab NG Einflaschengerät / Z-Cab NG single-bottle device
2025-04-28 13:24:26,695 [DEBUG] gui.bom_panel - BomPanel: 提取到Baugruppe: 1161296
2025-04-28 13:24:26,696 [DEBUG] gui.bom_panel - BomPanel: 提取到占位符: PL-Sitze04
2025-04-28 13:24:26,697 [DEBUG] gui.bom_panel - BomPanel: 构建的BOM码: PL-Sitze04-1161296
2025-04-28 13:24:26,697 [DEBUG] gui.bom_panel - BomPanel: 获取根窗口成功
2025-04-28 13:24:26,698 [DEBUG] gui.bom_panel - BomPanel: 获取MainWindow实例成功
2025-04-28 13:24:26,699 [DEBUG] gui.bom_panel - BomPanel: 找到逻辑面板
2025-04-28 13:24:26,699 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: PL-Sitze04-1161296
2025-04-28 13:24:26,700 [DEBUG] gui.logic_panel - 验证BOM码: PL-Sitze04-1161296
2025-04-28 13:24:26,700 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: BOM_code, 内容: PL-Sitze04-1161296, 当前表达式: K03_03_02  → PL-Sitze04-1161296 
2025-04-28 13:24:26,701 [INFO] gui.bom_panel - BomPanel: 成功发送代码到逻辑面板: PL-Sitze04-1161296
2025-04-28 13:24:26,702 [INFO] gui.bom_panel - BomPanel: 成功插入BOM码: PL-Sitze04-1161296
2025-04-28 13:24:28,144 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 3 条规则
2025-04-28 13:24:28,148 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 3 条规则
2025-04-28 13:24:28,149 [INFO] core.logic_builder - 规则数据已保存到文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:24:28,150 [INFO] gui.logic_panel - 已保存新的BOM逻辑关系规则: ID=BL02, 选择项=K03_03_02, 影响项=PL-Sitze04-1161296, 状态=enabled
2025-04-28 13:24:31,193 [DEBUG] gui.config_panel - ConfigPanel: 双击选中项 ID: I07F
2025-04-28 13:24:31,194 [DEBUG] gui.config_panel - ConfigPanel: 选中项文本: K03_04_02 original Fahrgestell (weiß)
2025-04-28 13:24:31,195 [DEBUG] gui.config_panel - ConfigPanel: 提取的代码: K03_04_02
2025-04-28 13:24:31,196 [INFO] gui.config_panel - ConfigPanel: 准备插入K码: K03_04_02
2025-04-28 13:24:31,197 [DEBUG] gui.config_panel - ConfigPanel: 获取根窗口成功
2025-04-28 13:24:31,198 [DEBUG] gui.config_panel - ConfigPanel: 获取MainWindow实例成功
2025-04-28 13:24:31,199 [DEBUG] gui.config_panel - ConfigPanel: 找到逻辑面板
2025-04-28 13:24:31,200 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: K03_04_02
2025-04-28 13:24:31,200 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: K_code, 内容: K03_04_02, 当前表达式: K03_04_02 
2025-04-28 13:24:31,201 [INFO] gui.config_panel - ConfigPanel: 成功发送代码到逻辑面板: K03_04_02
2025-04-28 13:24:32,554 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: operator, 内容: →, 当前表达式: K03_04_02  → 
2025-04-28 13:24:33,078 [DEBUG] gui.bom_panel - BomPanel: 双击选中项 ID: I04D
2025-04-28 13:24:33,079 [DEBUG] gui.bom_panel - BomPanel: 选中项文本: 1161313 - PA-Sitz f.Straffer li.kpl.mech / BA-seat f. tensioner le. cpl. mech.
Z-Cab NG Einflaschengerät / Z-Cab NG single-bottle device
2025-04-28 13:24:33,079 [DEBUG] gui.bom_panel - BomPanel: 提取到Baugruppe: 1161313
2025-04-28 13:24:33,080 [DEBUG] gui.bom_panel - BomPanel: 提取到占位符: PL-Sitze04
2025-04-28 13:24:33,081 [DEBUG] gui.bom_panel - BomPanel: 构建的BOM码: PL-Sitze04-1161313
2025-04-28 13:24:33,081 [DEBUG] gui.bom_panel - BomPanel: 获取根窗口成功
2025-04-28 13:24:33,082 [DEBUG] gui.bom_panel - BomPanel: 获取MainWindow实例成功
2025-04-28 13:24:33,083 [DEBUG] gui.bom_panel - BomPanel: 找到逻辑面板
2025-04-28 13:24:33,084 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: PL-Sitze04-1161313
2025-04-28 13:24:33,085 [DEBUG] gui.logic_panel - 验证BOM码: PL-Sitze04-1161313
2025-04-28 13:24:33,086 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: BOM_code, 内容: PL-Sitze04-1161313, 当前表达式: K03_04_02  → PL-Sitze04-1161313 
2025-04-28 13:24:33,086 [INFO] gui.bom_panel - BomPanel: 成功发送代码到逻辑面板: PL-Sitze04-1161313
2025-04-28 13:24:33,087 [INFO] gui.bom_panel - BomPanel: 成功插入BOM码: PL-Sitze04-1161313
2025-04-28 13:24:34,511 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 4 条规则
2025-04-28 13:24:34,515 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 4 条规则
2025-04-28 13:24:34,516 [INFO] core.logic_builder - 规则数据已保存到文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:24:34,516 [INFO] gui.logic_panel - 已保存新的BOM逻辑关系规则: ID=BL04, 选择项=K03_04_02, 影响项=PL-Sitze04-1161313, 状态=enabled
2025-04-28 13:24:42,558 [DEBUG] gui.config_panel - ConfigPanel: 双击选中项 ID: I07F
2025-04-28 13:24:42,559 [DEBUG] gui.config_panel - ConfigPanel: 选中项文本: K03_04_02 original Fahrgestell (weiß)
2025-04-28 13:24:42,560 [DEBUG] gui.config_panel - ConfigPanel: 提取的代码: K03_04_02
2025-04-28 13:24:42,561 [INFO] gui.config_panel - ConfigPanel: 准备插入K码: K03_04_02
2025-04-28 13:24:42,561 [DEBUG] gui.config_panel - ConfigPanel: 获取根窗口成功
2025-04-28 13:24:42,562 [DEBUG] gui.config_panel - ConfigPanel: 获取MainWindow实例成功
2025-04-28 13:24:42,562 [DEBUG] gui.config_panel - ConfigPanel: 找到逻辑面板
2025-04-28 13:24:42,563 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: K03_04_02
2025-04-28 13:24:42,564 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: K_code, 内容: K03_04_02, 当前表达式: K03_04_02 
2025-04-28 13:24:42,564 [INFO] gui.config_panel - ConfigPanel: 成功发送代码到逻辑面板: K03_04_02
2025-04-28 13:24:43,476 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: operator, 内容: →, 当前表达式: K03_04_02  → 
2025-04-28 13:24:43,962 [DEBUG] gui.bom_panel - BomPanel: 双击选中项 ID: I04D
2025-04-28 13:24:43,963 [DEBUG] gui.bom_panel - BomPanel: 选中项文本: 1161313 - PA-Sitz f.Straffer li.kpl.mech / BA-seat f. tensioner le. cpl. mech.
Z-Cab NG Einflaschengerät / Z-Cab NG single-bottle device
2025-04-28 13:24:43,964 [DEBUG] gui.bom_panel - BomPanel: 提取到Baugruppe: 1161313
2025-04-28 13:24:43,965 [DEBUG] gui.bom_panel - BomPanel: 提取到占位符: PL-Sitze04
2025-04-28 13:24:43,965 [DEBUG] gui.bom_panel - BomPanel: 构建的BOM码: PL-Sitze04-1161313
2025-04-28 13:24:43,966 [DEBUG] gui.bom_panel - BomPanel: 获取根窗口成功
2025-04-28 13:24:43,967 [DEBUG] gui.bom_panel - BomPanel: 获取MainWindow实例成功
2025-04-28 13:24:43,967 [DEBUG] gui.bom_panel - BomPanel: 找到逻辑面板
2025-04-28 13:24:43,968 [DEBUG] gui.logic_panel - LogicPanel: 开始插入代码: PL-Sitze04-1161313
2025-04-28 13:24:43,969 [DEBUG] gui.logic_panel - 验证BOM码: PL-Sitze04-1161313
2025-04-28 13:24:43,970 [INFO] gui.logic_panel - LogicPanel: 输入历史 - 类型: BOM_code, 内容: PL-Sitze04-1161313, 当前表达式: K03_04_02  → PL-Sitze04-1161313 
2025-04-28 13:24:43,970 [INFO] gui.bom_panel - BomPanel: 成功发送代码到逻辑面板: PL-Sitze04-1161313
2025-04-28 13:24:43,971 [INFO] gui.bom_panel - BomPanel: 成功插入BOM码: PL-Sitze04-1161313
2025-04-28 13:24:44,831 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 5 条规则
2025-04-28 13:24:44,836 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 5 条规则
2025-04-28 13:24:44,837 [INFO] core.logic_builder - 规则数据已保存到文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:24:44,838 [INFO] gui.logic_panel - 已保存新的BOM逻辑关系规则: ID=BL05, 选择项=K03_04_02, 影响项=PL-Sitze04-1161313, 状态=enabled
2025-04-28 13:26:06,608 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 4 条规则
2025-04-28 13:26:06,612 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 4 条规则
2025-04-28 13:26:06,612 [INFO] core.logic_builder - 规则数据已保存到文件: C:\Users\mengy\Desktop\ZK_LogicBom_Builder\data\temp_rules_latest.json
2025-04-28 13:26:06,612 [INFO] gui.logic_panel - 收到规则变更事件: type=deleted, rule_id=BL01
2025-04-28 13:26:06,613 [INFO] gui.logic_library_window - 收到规则变更事件: type=deleted, rule_id=BL01
2025-04-28 13:26:06,613 [INFO] gui.logic_library_window - 已删除规则: BL01
2025-04-28 13:26:11,224 [INFO] core.logic_builder - 规则数据已保存到临时文件，共 3 条规则
2025-04-28 13:26:11,224 [INFO] gui.logic_panel - 收到规则变更事件: type=deleted, rule_id=BL03
2025-04-28 13:26:11,224 [INFO] gui.logic_panel - 已删除规则: BL03
2025-04-28 13:26:11,225 [INFO] gui.logic_library_window - 收到规则变更事件: type=deleted, rule_id=BL03
2025-04-28 13:26:11,225 [INFO] gui.logic_library_window - 已删除规则: BL03
